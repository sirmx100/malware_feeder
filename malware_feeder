#!/bin/bash
# malware links downloader by country
_feed="https://urlhaus.abuse.ch/feeds/country/"
_cnames=(
US
SE
CZ
DE
HK
PL
TR
NO
NL
BA
RS
IT
AT
HR
GB
GR
DE
LV
ES
AU
UA
IN
CN
MY
CY
TW
BA
VN
LV
CL
PT
DK
IL
KR
ZA
CA
SI
BR
FI
EE
FR
No
ID
RO
)
_cpwd="$PWD"
function mirror ()
{
	wget -c --no-check-certificate --recursive --no-clobber --page-requisites --html-extension --convert-links --restrict-file-names=windows --no-parent --mirror $1
}
mkdir -v malware_feeds
cd malware_feeds
for country in ${_cnames[@]}; do cd $country;echo "Getting list for $country";curl -L https://urlhaus.abuse.ch/feeds/country/$country/|sed 's/"/ /g'|awk '/online/{print $4}' > $country.list;cd $_cpwd;done
mv *.list malware_feeds/
cd malware_feeds
ls|while read line; do cat "$line"|while read link; do mirror "$link";done;done
